function renderGraph (){


// var pm25.json = require('pm25.json');
  //UI configuration
  var itemSize = 18,
  cellSize = itemSize-1,
  width = 800,
  height = 800,
  margin = {top:20,right:20,bottom:20,left:25};

  formats
  var secondsFormat = d3.time.format('%s')
    // dayFormat = d3.time.format('%j'),
    // timeFormat = d3.time.format('%Y-%m-%dT%X'),
    // monthDayFormat = d3.time.format('%m.%d');

  //data vars for rendering
  var dateExtent = null,
  data = null,
  dayOffset = 0,
  colorCalibration = ['#f6faaa','#FEE08B','#FDAE61','#F46D43','#D53E4F','#9E0142'],
  dailyValueExtent = {};

  //axises and scales
  var axisWidth = 0 ,
  axisHeight = itemSize*12,
  xAxisScale = d3.time.scale(),
  xAxis = d3.svg.axis()
  .orient('top')
  .ticks(d3.time.seconds,10)
  .tickFormat(secondsFormat),
  yAxisScale = d3.scale.linear()
  .range([0,axisHeight])
  .domain([0,12]),
  yAxis = d3.svg.axis()
  .orient('left')
  .ticks(12)
  .tickFormat(d3.format('02d'))
  .scale(yAxisScale);

  initCalibration();

  var svg = d3.select('[role="heatmap"]');
  var heatmap = svg
  .attr('width',width)
  .attr('height',height)
  .append('g')
  .attr('width',width-margin.left-margin.right)
  .attr('height',height-margin.top-margin.bottom)
  .attr('transform','translate('+margin.left+','+margin.top+')');
  var rect = null;

  // d3.json('/public/javascripts/pm25.json',function(err,data){

// data = [{"start":0,"pitches":[1,0.983,0.868,0.844,0.832,0.791,0.779,0.776,0.713,0.673,0.595,0.538]},{"start":1.76726,"pitches":[0.75,0.943,0.912,0.913,0.992,1,0.688,0.692,0.682,0.678,0.354,0.288]},{"start":1.85007,"pitches":[0.081,0.027,0.02,0.015,0.031,0.015,0.137,1,0.1,0.01,0.014,0.448]},{"start":2.19959,"pitches":[0.153,0.007,0.018,0.005,0.009,0.04,0.415,1,0.325,0.013,0.006,0.277]},{"start":2.39388,"pitches":[0.124,0.008,0.042,0.006,0.009,0.037,0.423,1,0.313,0.012,0.007,0.232]},{"start":2.58698,"pitches":[0.012,0.028,0.014,0.013,0.346,0.033,0.015,0.085,0.02,1,0.596,0.568]},{"start":5.27587,"pitches":[0.042,0.117,0.008,0.01,0.876,0.029,0.019,0.052,0.063,1,0.15,0.154]},{"start":5.56785,"pitches":[0.545,0.266,0.028,0.075,1,0.082,0.095,0.303,0.097,0.913,0.208,0.417]},{"start":5.9093,"pitches":[1,0.239,0.022,0.024,0.311,0.042,0.055,0.617,0.516,0.574,0.872,0.244]},{"start":6.06005,"pitches":[0.242,0.219,0.842,0.075,0.257,0.057,0.087,0.367,0.267,0.567,1,0.946]},{"start":7.3663,"pitches":[0.54,0.072,1,0.067,0.012,0.007,0.055,0.025,0.322,0.869,0.907,0.014]},{"start":7.54032,"pitches":[0.167,0.088,1,0.181,0.07,0.036,0.131,0.044,0.08,0.711,0.316,0.285]},{"start":8.15034,"pitches":[0.179,0.076,0.876,0.156,0.27,0.047,0.112,0.041,0.086,0.787,0.798,1]},{"start":8.67302,"pitches":[0.074,0.015,0.108,0.023,0.417,0.034,0.014,0.008,0.015,0.062,0.341,1]},{"start":9.31769,"pitches":[0.088,0.004,0.015,0.005,0.598,0.046,0.005,0.004,0.011,0.008,0.153,1]},{"start":9.92041,"pitches":[0.148,0.01,0.016,0.014,0.44,0.056,0.008,0.009,0.091,0.012,0.01,1]},{"start":10.17601,"pitches":[0.187,0.079,0.111,0.118,1,0.42,0.06,0.057,0.183,0.088,0.101,0.749]},{"start":10.40231,"pitches":[0.129,0.044,0.078,0.067,0.407,0.109,0.044,0.039,0.074,0.068,0.709,1]},{"start":12.19701,"pitches":[0.844,0.403,0.196,0.135,0.108,0.112,0.108,0.123,0.64,0.87,1,0.195]},{"start":12.31873,"pitches":[0.877,0.313,0.394,0.916,0.82,0.402,0.198,0.131,0.347,0.845,0.231,1]},{"start":12.51542,"pitches":[1,0.132,0.277,0.645,0.577,0.434,0.399,0.589,0.284,0.217,0.307,0.934]},{"start":12.73075,"pitches":[0.669,0.421,0.233,0.353,0.358,0.686,1,0.458,0.404,0.414,0.381,0.369]},{"start":12.95655,"pitches":[0.471,0.549,0.65,0.456,0.852,0.963,0.539,0.636,0.556,1,0.398,0.458]},{"start":13.21188,"pitches":[0.15,0.131,0.357,0.211,0.435,0.182,0.474,1,0.421,0.438,0.101,0.148]},{"start":13.41537,"pitches":[0.347,0.306,0.472,0.501,1,0.6,0.7,0.745,0.63,0.568,0.4,0.628]},{"start":13.98395,"pitches":[0.468,0.423,0.285,0.298,0.731,1,0.586,0.381,0.342,0.488,0.256,0.751]},{"start":14.14707,"pitches":[0.347,0.427,0.643,0.508,1,0.874,0.879,0.95,0.8,0.904,0.445,0.356]},{"start":14.33234,"pitches":[0.34,0.395,0.641,0.405,1,0.418,0.534,0.314,0.429,0.819,0.354,0.46]},{"start":14.67465,"pitches":[0.134,0.094,0.114,0.158,1,0.297,0.242,0.241,0.233,0.177,0.126,0.258]},{"start":15.29093,"pitches":[0.798,1,0.234,0.232,0.771,0.548,0.423,0.436,0.754,0.612,0.739,0.289]},{"start":15.44141,"pitches":[0.424,0.267,0.358,0.538,1,0.654,0.543,0.494,0.552,0.832,0.629,0.395]},{"start":15.57991,"pitches":[0.816,0.92,0.51,0.348,0.737,0.534,0.402,1,0.589,0.831,0.607,0.442]},{"start":15.72535,"pitches":[1,0.341,0.14,0.124,0.356,0.129,0.131,0.512,0.103,0.148,0.25,0.168]},{"start":15.89982,"pitches":[0.841,0.63,0.6,0.574,0.858,1,0.579,0.705,0.308,0.266,0.399,0.455]},{"start":16.1259,"pitches":[1,0.34,0.361,0.322,0.384,0.299,0.349,0.517,0.199,0.21,0.31,0.478]},{"start":16.24844,"pitches":[0.623,0.492,0.622,0.355,0.579,0.376,0.54,1,0.365,0.402,0.676,0.487]},{"start":16.54993,"pitches":[0.731,0.94,0.686,0.376,0.388,0.388,0.395,1,0.56,0.359,0.563,0.282]},{"start":16.70077,"pitches":[0.828,0.525,0.293,0.277,0.487,0.466,0.628,1,0.691,0.582,0.475,0.22]},{"start":16.86299,"pitches":[0.927,0.285,0.181,0.111,0.228,0.129,0.106,1,0.157,0.123,0.172,0.195]},{"start":17.13669,"pitches":[1,0.545,0.506,0.468,0.536,0.659,0.531,0.824,0.449,0.303,0.397,0.519]},{"start":17.39179,"pitches":[1,0.357,0.517,0.276,0.367,0.357,0.329,0.454,0.19,0.232,0.377,0.507]},{"start":17.50236,"pitches":[0.913,0.404,0.515,0.277,0.22,0.163,0.18,1,0.245,0.233,0.357,0.337]},{"start":17.80385,"pitches":[0.391,0.425,0.65,0.481,0.355,0.24,0.428,1,0.515,0.351,0.45,0.365]},{"start":17.99578,"pitches":[0.572,0.494,0.436,0.303,0.347,0.259,0.465,1,0.597,0.77,0.444,0.557]},{"start":18.12916,"pitches":[0.384,0.308,0.576,0.371,0.799,0.201,0.381,0.406,0.539,1,0.468,0.391]},{"start":18.28594,"pitches":[0.266,0.149,0.502,0.142,0.468,0.33,0.737,0.804,0.521,1,0.241,0.346]},{"start":18.37846,"pitches":[0.273,0.242,0.36,0.231,1,0.35,0.263,0.398,0.518,0.497,0.323,0.539]},{"start":19.0288,"pitches":[0.476,0.524,0.58,0.558,0.97,0.91,0.682,0.392,0.601,0.521,0.374,1]},{"start":19.33029,"pitches":[0.411,0.645,1,0.515,0.802,0.491,0.858,0.535,0.54,0.699,0.327,0.655]},{"start":19.59184,"pitches":[0.384,0.413,1,0.361,0.569,0.369,0.974,0.359,0.397,0.57,0.345,0.335]},{"start":19.67306,"pitches":[0.159,0.138,0.172,0.22,1,0.261,0.292,0.364,0.402,0.231,0.198,0.224]},{"start":20.34077,"pitches":[0.936,1,0.738,0.793,0.656,0.585,0.648,0.764,0.604,0.503,0.664,0.755]},{"start":20.4161,"pitches":[0.343,0.319,0.383,0.539,1,0.565,0.412,0.319,0.444,0.859,0.45,0.415]},{"start":20.63079,"pitches":[0.942,0.251,0.219,0.234,0.285,0.211,0.257,1,0.256,0.198,0.162,0.403]},{"start":20.8922,"pitches":[0.819,0.654,0.607,0.487,0.687,0.606,0.577,1,0.358,0.347,0.318,0.485]},{"start":21.2463,"pitches":[0.658,0.57,0.384,0.276,0.354,0.317,0.486,1,0.488,0.424,0.52,0.399]},{"start":21.52512,"pitches":[0.283,0.342,0.266,0.222,0.242,0.371,0.335,1,0.268,0.205,0.195,0.168]},{"start":21.71646,"pitches":[0.616,0.614,0.432,0.304,0.355,0.417,0.457,1,0.736,0.58,0.619,0.208]},{"start":21.82698,"pitches":[1,0.329,0.224,0.166,0.243,0.198,0.392,0.818,0.403,0.183,0.255,0.278]},{"start":22.16943,"pitches":[1,0.125,0.085,0.069,0.115,0.116,0.148,0.254,0.072,0.077,0.138,0.138]},{"start":22.81392,"pitches":[1,0.918,0.507,0.194,0.301,0.472,0.292,0.316,0.405,0.315,0.399,0.64]},{"start":23.01655,"pitches":[0.58,0.649,0.465,0.431,0.381,0.358,0.429,0.663,0.921,1,0.654,0.342]},{"start":23.19669,"pitches":[0.215,0.23,0.626,0.198,0.625,0.178,0.763,1,0.383,0.573,0.124,0.342]},{"start":23.44639,"pitches":[0.231,0.24,0.399,0.181,1,0.333,0.637,0.812,0.459,0.366,0.208,0.313]},{"start":23.77111,"pitches":[0.213,0.268,0.285,0.254,1,0.302,0.236,0.224,0.374,0.408,0.258,0.372]},{"start":24.05569,"pitches":[0.777,0.607,0.398,0.484,0.962,0.918,0.849,0.487,0.565,0.573,0.347,1]},{"start":24.22376,"pitches":[0.777,0.742,0.479,0.441,0.755,0.869,1,0.902,0.868,0.97,0.599,0.819]},{"start":24.39819,"pitches":[0.424,0.391,1,0.409,0.9,0.415,0.648,0.395,0.66,0.732,0.358,0.679]},{"start":24.72336,"pitches":[0.143,0.158,0.2,0.243,1,0.295,0.244,0.254,0.291,0.217,0.159,0.237]},{"start":25.32136,"pitches":[0.867,0.897,0.342,0.325,0.637,0.802,0.746,0.862,1,0.924,0.902,0.382]},{"start":25.47238,"pitches":[0.439,0.225,0.297,0.409,1,0.678,0.47,0.44,0.451,0.492,0.294,0.35]},{"start":25.58272,"pitches":[0.616,0.398,0.365,0.671,0.964,1,0.946,0.603,0.556,0.558,0.578,0.445]},{"start":25.76812,"pitches":[0.836,0.541,0.343,0.27,0.432,0.286,0.423,1,0.36,0.278,0.521,0.352]},{"start":25.84435,"pitches":[0.713,0.489,0.301,0.29,0.353,0.373,0.408,1,0.263,0.267,0.436,0.332]},{"start":25.92535,"pitches":[1,0.329,0.231,0.264,0.434,0.462,0.619,0.758,0.242,0.299,0.363,0.37]},{"start":26.13986,"pitches":[0.911,0.466,0.321,0.489,0.371,0.262,0.518,1,0.494,0.412,0.53,0.501]},{"start":26.36027,"pitches":[0.687,0.361,0.363,0.25,0.442,0.472,0.946,1,0.425,0.303,0.308,0.28]},{"start":26.66803,"pitches":[0.66,0.383,0.363,0.315,0.392,0.325,0.347,1,0.679,0.503,0.583,0.501]},{"start":26.80145,"pitches":[1,0.215,0.276,0.204,0.316,0.247,0.364,0.954,0.206,0.18,0.286,0.278]},{"start":27.0917,"pitches":[1,0.359,0.48,0.243,0.375,0.461,0.373,0.929,0.248,0.256,0.315,0.274]},{"start":27.44086,"pitches":[0.581,0.446,0.398,0.249,0.252,0.15,0.253,1,0.231,0.202,0.248,0.338]},{"start":27.73637,"pitches":[0.167,0.166,0.137,0.328,1,0.453,0.242,0.177,0.189,0.175,0.14,0.191]},{"start":28.08063,"pitches":[0.219,0.207,0.509,0.121,0.662,0.264,0.417,1,0.587,0.317,0.093,0.243]},{"start":28.32848,"pitches":[0.254,0.193,0.361,0.225,1,0.352,0.298,0.384,0.487,0.295,0.269,0.499]},{"start":28.98408,"pitches":[0.894,0.86,0.796,0.48,0.962,0.72,0.777,0.368,0.535,0.422,0.327,1]},{"start":29.21007,"pitches":[0.772,0.888,0.591,0.807,0.953,0.806,0.789,0.658,0.66,0.697,0.656,1]},{"start":29.32086,"pitches":[0.967,0.914,0.921,0.922,0.723,0.982,0.815,0.774,0.834,0.836,0.787,1]},{"start":29.44853,"pitches":[0.378,0.41,1,0.272,0.729,0.351,0.466,0.281,0.377,0.523,0.223,0.383]},{"start":29.57678,"pitches":[0.427,0.455,0.675,0.489,1,0.669,0.629,0.395,0.434,0.454,0.431,0.583]},{"start":29.94227,"pitches":[0.264,0.284,0.237,0.263,1,0.257,0.186,0.151,0.263,0.204,0.175,0.423]},{"start":30.20889,"pitches":[0.477,0.307,0.315,0.357,0.885,0.804,0.591,1,0.784,0.883,0.453,0.665]},{"start":30.59687,"pitches":[1,0.466,0.372,0.235,0.304,0.265,0.239,0.515,0.22,0.183,0.151,0.568]},{"start":30.78984,"pitches":[1,0.666,0.362,0.351,0.247,0.188,0.305,0.619,0.315,0.333,0.729,0.395]},{"start":30.8595,"pitches":[0.85,0.503,0.453,0.348,0.399,0.703,0.734,1,0.333,0.306,0.33,0.414]},{"start":31.10902,"pitches":[0.855,0.428,0.747,0.569,0.571,0.527,0.613,1,0.672,0.664,0.571,0.438]},{"start":31.50893,"pitches":[0.371,0.243,0.307,0.303,0.28,0.357,0.223,1,0.31,0.213,0.203,0.327]},{"start":31.82299,"pitches":[0.838,0.521,0.47,0.43,0.429,0.451,0.207,1,0.403,0.216,0.264,0.285]},{"start":32.02639,"pitches":[1,0.534,0.342,0.14,0.372,0.229,0.203,0.788,0.203,0.19,0.501,0.176]},{"start":32.10753,"pitches":[1,0.176,0.205,0.168,0.308,0.204,0.24,0.99,0.219,0.219,0.318,0.206]},{"start":32.92667,"pitches":[0.471,0.459,0.446,0.642,1,0.665,0.338,0.617,0.385,0.589,0.357,0.704]},{"start":33.15787,"pitches":[0.184,0.192,0.373,0.184,0.473,0.239,1,0.909,0.429,0.464,0.151,0.269]},{"start":33.39605,"pitches":[0.22,0.186,0.273,0.464,1,0.573,0.573,0.541,0.627,0.555,0.441,0.387]},{"start":34.04054,"pitches":[0.585,0.656,0.27,0.309,0.686,1,0.557,0.193,0.265,0.249,0.234,0.49]},{"start":34.19751,"pitches":[0.662,0.746,0.436,0.428,0.665,0.486,0.819,0.609,0.774,1,0.67,0.709]},{"start":34.35946,"pitches":[0.356,0.277,0.409,0.415,0.427,1,0.396,0.152,0.143,0.58,0.524,0.245]},{"start":34.4356,"pitches":[0.31,0.366,1,0.271,0.578,0.256,0.354,0.221,0.28,0.699,0.224,0.333]},{"start":34.56925,"pitches":[0.414,0.3,1,0.432,0.777,0.394,0.693,0.36,0.265,0.668,0.215,0.703]},{"start":34.66753,"pitches":[0.188,0.204,0.367,0.519,1,0.331,0.219,0.215,0.268,0.277,0.183,0.324]},{"start":34.95188,"pitches":[0.181,0.163,0.187,0.327,1,0.202,0.148,0.136,0.364,0.209,0.226,0.366]},{"start":35.24803,"pitches":[0.457,0.338,0.457,0.373,0.889,1,0.324,0.336,0.511,0.454,0.473,0.481]},{"start":37.78399,"pitches":[0.535,0.349,0.548,0.274,0.625,1,0.346,0.384,0.426,0.406,0.454,0.334]}]

data = {"data":[{"timestamp":"2014-09-25T00:00:00","value":{"PM2.5":30.22}},{"timestamp":"2014-09-25T01:00:00","value":{"PM2.5":41.61}},{"timestamp":"2014-09-25T02:00:00","value":{"PM2.5":50.71}},{"timestamp":"2014-09-25T03:00:00","value":{"PM2.5":57.34}},{"timestamp":"2014-09-25T04:00:00","value":{"PM2.5":79.64}},{"timestamp":"2014-09-25T05:00:00","value":{"PM2.5":76.93}},{"timestamp":"2014-09-25T06:00:00","value":{"PM2.5":106.45}},{"timestamp":"2014-09-25T07:00:00","value":{"PM2.5":79.72}},{"timestamp":"2014-09-25T08:00:00","value":{"PM2.5":74.23}},{"timestamp":"2014-09-25T09:00:00","value":{"PM2.5":90.48}},{"timestamp":"2014-09-25T10:00:00","value":{"PM2.5":94.74}},{"timestamp":"2014-09-25T11:00:00","value":{"PM2.5":85.97}},{"timestamp":"2014-09-25T12:00:00","value":{"PM2.5":69.23}},{"timestamp":"2014-09-25T13:00:00","value":{"PM2.5":82.63}},{"timestamp":"2014-09-25T14:00:00","value":{"PM2.5":244.89}},{"timestamp":"2014-09-25T15:00:00","value":{"PM2.5":363.18}},{"timestamp":"2014-09-25T16:00:00","value":{"PM2.5":397.89}},{"timestamp":"2014-09-25T17:00:00","value":{"PM2.5":344.67}},{"timestamp":"2014-09-25T18:00:00","value":{"PM2.5":328.47}},{"timestamp":"2014-09-25T19:00:00","value":{"PM2.5":305.47}},{"timestamp":"2014-09-25T20:00:00","value":{"PM2.5":344.87}},{"timestamp":"2014-09-25T21:00:00","value":{"PM2.5":336.82}},{"timestamp":"2014-09-25T22:00:00","value":{"PM2.5":291.29}},{"timestamp":"2014-09-25T23:00:00","value":{"PM2.5":260.16}},{"timestamp":"2014-09-26T00:00:00","value":{"PM2.5":251.12}},{"timestamp":"2014-09-26T01:00:00","value":{"PM2.5":213.73}},{"timestamp":"2014-09-26T02:00:00","value":{"PM2.5":188.96}},{"timestamp":"2014-09-26T03:00:00","value":{"PM2.5":170.37}},{"timestamp":"2014-09-26T04:00:00","value":{"PM2.5":152.53}},{"timestamp":"2014-09-26T05:00:00","value":{"PM2.5":145.44}},{"timestamp":"2014-09-26T06:00:00","value":{"PM2.5":144.09}},{"timestamp":"2014-09-26T07:00:00","value":{"PM2.5":169.71}},{"timestamp":"2014-09-26T08:00:00","value":{"PM2.5":207.33}},{"timestamp":"2014-09-26T09:00:00","value":{"PM2.5":208.24}},{"timestamp":"2014-09-26T10:00:00","value":{"PM2.5":215.42}},{"timestamp":"2014-09-26T11:00:00","value":{"PM2.5":208.86}},{"timestamp":"2014-09-26T12:00:00","value":{"PM2.5":239.67}},{"timestamp":"2014-09-26T13:00:00","value":{"PM2.5":242.51}},{"timestamp":"2014-09-26T14:00:00","value":{"PM2.5":252.05}},{"timestamp":"2014-09-26T15:00:00","value":{"PM2.5":239.24}},{"timestamp":"2014-09-26T16:00:00","value":{"PM2.5":254.14}},{"timestamp":"2014-09-26T17:00:00","value":{"PM2.5":287.29}},{"timestamp":"2014-09-26T18:00:00","value":{"PM2.5":280.43}},{"timestamp":"2014-09-26T19:00:00","value":{"PM2.5":294.95}},{"timestamp":"2014-09-26T20:00:00","value":{"PM2.5":269.68}},{"timestamp":"2014-09-26T21:00:00","value":{"PM2.5":105.62}},{"timestamp":"2014-09-26T22:00:00","value":{"PM2.5":94.32}},{"timestamp":"2014-09-26T23:00:00","value":{"PM2.5":66.55}},{"timestamp":"2014-09-27T00:00:00","value":{"PM2.5":76.33}},{"timestamp":"2014-09-27T01:00:00","value":{"PM2.5":27.83}},{"timestamp":"2014-09-27T02:00:00","value":{"PM2.5":62.01}},{"timestamp":"2014-09-27T03:00:00","value":{"PM2.5":43.96}},{"timestamp":"2014-09-27T04:00:00","value":{"PM2.5":26.89}},{"timestamp":"2014-09-27T05:00:00","value":{"PM2.5":26.23}},{"timestamp":"2014-09-27T06:00:00","value":{"PM2.5":21.32}},{"timestamp":"2014-09-27T07:00:00","value":{"PM2.5":20.81}},{"timestamp":"2014-09-27T08:00:00","value":{"PM2.5":24.04}},{"timestamp":"2014-09-27T09:00:00","value":{"PM2.5":21.65}},{"timestamp":"2014-09-27T10:00:00","value":{"PM2.5":10.51}},{"timestamp":"2014-09-27T11:00:00","value":{"PM2.5":8.92}},{"timestamp":"2014-09-27T12:00:00","value":{"PM2.5":6.97}},{"timestamp":"2014-09-27T13:00:00","value":{"PM2.5":4.3}},{"timestamp":"2014-09-27T14:00:00","value":{"PM2.5":5.38}},{"timestamp":"2014-09-27T15:00:00","value":{"PM2.5":12.7}},{"timestamp":"2014-09-27T16:00:00","value":{"PM2.5":11.07}},{"timestamp":"2014-09-27T17:00:00","value":{"PM2.5":26.12}},{"timestamp":"2014-09-27T18:00:00","value":{"PM2.5":155.54}},{"timestamp":"2014-09-27T19:00:00","value":{"PM2.5":16.69}},{"timestamp":"2014-09-27T20:00:00","value":{"PM2.5":10.73}},{"timestamp":"2014-09-27T21:00:00","value":{"PM2.5":10.09}},{"timestamp":"2014-09-27T22:00:00","value":{"PM2.5":17.9}},{"timestamp":"2014-09-27T23:00:00","value":{"PM2.5":21.24}},{"timestamp":"2014-09-28T00:00:00","value":{"PM2.5":22.61}},{"timestamp":"2014-09-28T01:00:00","value":{"PM2.5":27.05}},{"timestamp":"2014-09-28T02:00:00","value":{"PM2.5":24.34}},{"timestamp":"2014-09-28T03:00:00","value":{"PM2.5":19.63}},{"timestamp":"2014-09-28T04:00:00","value":{"PM2.5":26.33}},{"timestamp":"2014-09-28T05:00:00","value":{"PM2.5":23.62}},{"timestamp":"2014-09-28T06:00:00","value":{"PM2.5":21.46}},{"timestamp":"2014-09-28T07:00:00","value":{"PM2.5":24.73}},{"timestamp":"2014-09-28T08:00:00","value":{"PM2.5":44.34}},{"timestamp":"2014-09-28T09:00:00","value":{"PM2.5":35.01}},{"timestamp":"2014-09-28T10:00:00","value":{"PM2.5":33.54}},{"timestamp":"2014-09-28T11:00:00","value":{"PM2.5":38.61}},{"timestamp":"2014-09-28T12:00:00","value":{"PM2.5":80.41}},{"timestamp":"2014-09-28T13:00:00","value":{"PM2.5":77.11}},{"timestamp":"2014-09-28T14:00:00","value":{"PM2.5":74.43}},{"timestamp":"2014-09-28T15:00:00","value":{"PM2.5":97.76}},{"timestamp":"2014-09-28T16:00:00","value":{"PM2.5":121.23}},{"timestamp":"2014-09-28T17:00:00","value":{"PM2.5":151.39}},{"timestamp":"2014-09-28T18:00:00","value":{"PM2.5":145.58}},{"timestamp":"2014-09-28T19:00:00","value":{"PM2.5":133.08}},{"timestamp":"2014-09-28T20:00:00","value":{"PM2.5":111.6}},{"timestamp":"2014-09-28T21:00:00","value":{"PM2.5":118.36}},{"timestamp":"2014-09-28T22:00:00","value":{"PM2.5":117.77}},{"timestamp":"2014-09-28T23:00:00","value":{"PM2.5":125.95}},{"timestamp":"2014-09-29T00:00:00","value":{"PM2.5":126.74}},{"timestamp":"2014-09-29T01:00:00","value":{"PM2.5":121.47}},{"timestamp":"2014-09-29T02:00:00","value":{"PM2.5":113.75}},{"timestamp":"2014-09-29T03:00:00","value":{"PM2.5":117.12}},{"timestamp":"2014-09-29T04:00:00","value":{"PM2.5":130.76}},{"timestamp":"2014-09-29T05:00:00","value":{"PM2.5":126.4}},{"timestamp":"2014-09-29T06:00:00","value":{"PM2.5":136.94}},{"timestamp":"2014-09-29T07:00:00","value":{"PM2.5":129.97}},{"timestamp":"2014-09-29T08:00:00","value":{"PM2.5":155.04}},{"timestamp":"2014-09-29T09:00:00","value":{"PM2.5":112.96}},{"timestamp":"2014-09-29T10:00:00","value":{"PM2.5":23.58}},{"timestamp":"2014-09-29T11:00:00","value":{"PM2.5":15.25}},{"timestamp":"2014-09-29T12:00:00","value":{"PM2.5":14.04}},{"timestamp":"2014-09-29T13:00:00","value":{"PM2.5":10.1}},{"timestamp":"2014-09-29T14:00:00","value":{"PM2.5":6.55}},{"timestamp":"2014-09-29T15:00:00","value":{"PM2.5":5.64}},{"timestamp":"2014-09-29T16:00:00","value":{"PM2.5":6.75}},{"timestamp":"2014-09-29T17:00:00","value":{"PM2.5":7.12}},{"timestamp":"2014-09-29T18:00:00","value":{"PM2.5":8.91}},{"timestamp":"2014-09-29T19:00:00","value":{"PM2.5":9.57}},{"timestamp":"2014-09-29T20:00:00","value":{"PM2.5":12.11}},{"timestamp":"2014-09-29T21:00:00","value":{"PM2.5":10.14}},{"timestamp":"2014-09-29T22:00:00","value":{"PM2.5":7.79}},{"timestamp":"2014-09-29T23:00:00","value":{"PM2.5":6.14}},{"timestamp":"2014-09-30T00:00:00","value":{"PM2.5":18.59}},{"timestamp":"2014-09-30T01:00:00","value":{"PM2.5":22.16}},{"timestamp":"2014-09-30T02:00:00","value":{"PM2.5":16.92}},{"timestamp":"2014-09-30T03:00:00","value":{"PM2.5":25.11}},{"timestamp":"2014-09-30T04:00:00","value":{"PM2.5":40.97}},{"timestamp":"2014-09-30T05:00:00","value":{"PM2.5":45.79}},{"timestamp":"2014-09-30T06:00:00","value":{"PM2.5":36.7}},{"timestamp":"2014-09-30T07:00:00","value":{"PM2.5":14.18}},{"timestamp":"2014-09-30T08:00:00","value":{"PM2.5":24.86}},{"timestamp":"2014-09-30T09:00:00","value":{"PM2.5":20.39}},{"timestamp":"2014-09-30T10:00:00","value":{"PM2.5":19.79}},{"timestamp":"2014-09-30T11:00:00","value":{"PM2.5":19.46}},{"timestamp":"2014-09-30T12:00:00","value":{"PM2.5":31.15}},{"timestamp":"2014-09-30T13:00:00","value":{"PM2.5":24.06}},{"timestamp":"2014-09-30T14:00:00","value":{"PM2.5":30.12}},{"timestamp":"2014-09-30T15:00:00","value":{"PM2.5":31.57}},{"timestamp":"2014-09-30T16:00:00","value":{"PM2.5":34.88}},{"timestamp":"2014-09-30T17:00:00","value":{"PM2.5":41.16}},{"timestamp":"2014-09-30T18:00:00","value":{"PM2.5":47.41}},{"timestamp":"2014-09-30T19:00:00","value":{"PM2.5":58.39}},{"timestamp":"2014-09-30T20:00:00","value":{"PM2.5":42.18}},{"timestamp":"2014-09-30T21:00:00","value":{"PM2.5":40.16}},{"timestamp":"2014-09-30T22:00:00","value":{"PM2.5":39.45}},{"timestamp":"2014-09-30T23:00:00","value":{"PM2.5":37.49}},{"timestamp":"2014-10-01T00:00:00","value":{"PM2.5":42.77}},{"timestamp":"2014-10-01T01:00:00","value":{"PM2.5":43.73}},{"timestamp":"2014-10-01T02:00:00","value":{"PM2.5":41.56}},{"timestamp":"2014-10-01T03:00:00","value":{"PM2.5":40.69}},{"timestamp":"2014-10-01T04:00:00","value":{"PM2.5":42.65}},{"timestamp":"2014-10-01T05:00:00","value":{"PM2.5":43.86}},{"timestamp":"2014-10-01T06:00:00","value":{"PM2.5":40.06}},{"timestamp":"2014-10-01T07:00:00","value":{"PM2.5":58.56}},{"timestamp":"2014-10-01T08:00:00","value":{"PM2.5":57.51}},{"timestamp":"2014-10-01T09:00:00","value":{"PM2.5":69.77}},{"timestamp":"2014-10-01T10:00:00","value":{"PM2.5":76.35}},{"timestamp":"2014-10-01T11:00:00","value":{"PM2.5":72.26}},{"timestamp":"2014-10-01T12:00:00","value":{"PM2.5":95.8}},{"timestamp":"2014-10-01T13:00:00","value":{"PM2.5":104.79}},{"timestamp":"2014-10-01T14:00:00","value":{"PM2.5":93.45}},{"timestamp":"2014-10-01T15:00:00","value":{"PM2.5":81.69}},{"timestamp":"2014-10-01T16:00:00","value":{"PM2.5":88.27}},{"timestamp":"2014-10-01T17:00:00","value":{"PM2.5":86.08}},{"timestamp":"2014-10-01T18:00:00","value":{"PM2.5":78.72}},{"timestamp":"2014-10-01T19:00:00","value":{"PM2.5":82.31}},{"timestamp":"2014-10-01T20:00:00","value":{"PM2.5":73.06}},{"timestamp":"2014-10-01T21:00:00","value":{"PM2.5":62.12}},{"timestamp":"2014-10-01T22:00:00","value":{"PM2.5":54.43}},{"timestamp":"2014-10-01T23:00:00","value":{"PM2.5":41.78}},{"timestamp":"2014-10-02T00:00:00","value":{"PM2.5":34.93}},{"timestamp":"2014-10-02T01:00:00","value":{"PM2.5":33.22}},{"timestamp":"2014-10-02T02:00:00","value":{"PM2.5":33.72}},{"timestamp":"2014-10-02T03:00:00","value":{"PM2.5":33.46}},{"timestamp":"2014-10-02T04:00:00","value":{"PM2.5":25.31}},{"timestamp":"2014-10-02T05:00:00","value":{"PM2.5":22.46}},{"timestamp":"2014-10-02T06:00:00","value":{"PM2.5":22.94}},{"timestamp":"2014-10-02T07:00:00","value":{"PM2.5":20.19}},{"timestamp":"2014-10-02T08:00:00","value":{"PM2.5":26.69}},{"timestamp":"2014-10-02T09:00:00","value":{"PM2.5":17.44}},{"timestamp":"2014-10-02T10:00:00","value":{"PM2.5":14.73}},{"timestamp":"2014-10-02T11:00:00","value":{"PM2.5":17.8}},{"timestamp":"2014-10-02T12:00:00","value":{"PM2.5":19.19}},{"timestamp":"2014-10-02T13:00:00","value":{"PM2.5":16.25}},{"timestamp":"2014-10-02T14:00:00","value":{"PM2.5":18.47}},{"timestamp":"2014-10-02T15:00:00","value":{"PM2.5":16.45}},{"timestamp":"2014-10-02T16:00:00","value":{"PM2.5":30.11}},{"timestamp":"2014-10-02T17:00:00","value":{"PM2.5":48.26}},{"timestamp":"2014-10-02T18:00:00","value":{"PM2.5":38.79}},{"timestamp":"2014-10-02T19:00:00","value":{"PM2.5":27.05}},{"timestamp":"2014-10-02T20:00:00","value":{"PM2.5":14.22}},{"timestamp":"2014-10-02T21:00:00","value":{"PM2.5":11.8}},{"timestamp":"2014-10-02T22:00:00","value":{"PM2.5":10.11}},{"timestamp":"2014-10-02T23:00:00","value":{"PM2.5":7.61}},{"timestamp":"2014-10-03T00:00:00","value":{"PM2.5":8.89}},{"timestamp":"2014-10-03T01:00:00","value":{"PM2.5":12.88}},{"timestamp":"2014-10-03T02:00:00","value":{"PM2.5":19.39}},{"timestamp":"2014-10-03T03:00:00","value":{"PM2.5":20.57}},{"timestamp":"2014-10-03T04:00:00","value":{"PM2.5":18.02}},{"timestamp":"2014-10-03T05:00:00","value":{"PM2.5":14.1}},{"timestamp":"2014-10-03T06:00:00","value":{"PM2.5":10.78}},{"timestamp":"2014-10-03T07:00:00","value":{"PM2.5":14.65}},{"timestamp":"2014-10-03T08:00:00","value":{"PM2.5":17.8}},{"timestamp":"2014-10-03T09:00:00","value":{"PM2.5":20.03}},{"timestamp":"2014-10-03T10:00:00","value":{"PM2.5":18.75}},{"timestamp":"2014-10-03T11:00:00","value":{"PM2.5":32.49}},{"timestamp":"2014-10-03T12:00:00","value":{"PM2.5":21.53}},{"timestamp":"2014-10-03T13:00:00","value":{"PM2.5":29.86}},{"timestamp":"2014-10-03T14:00:00","value":{"PM2.5":54.58}},{"timestamp":"2014-10-03T15:00:00","value":{"PM2.5":158.79}},{"timestamp":"2014-10-03T16:00:00","value":{"PM2.5":201.58}},{"timestamp":"2014-10-03T17:00:00","value":{"PM2.5":225.76}},{"timestamp":"2014-10-03T18:00:00","value":{"PM2.5":276.68}},{"timestamp":"2014-10-03T19:00:00","value":{"PM2.5":290.5}},{"timestamp":"2014-10-03T20:00:00","value":{"PM2.5":296.66}},{"timestamp":"2014-10-03T21:00:00","value":{"PM2.5":313.71}},{"timestamp":"2014-10-03T22:00:00","value":{"PM2.5":329.96}},{"timestamp":"2014-10-03T23:00:00","value":{"PM2.5":323.84}},{"timestamp":"2014-10-04T00:00:00","value":{"PM2.5":311.63}},{"timestamp":"2014-10-04T01:00:00","value":{"PM2.5":253.53}},{"timestamp":"2014-10-04T02:00:00","value":{"PM2.5":195.69}},{"timestamp":"2014-10-04T03:00:00","value":{"PM2.5":140.67}},{"timestamp":"2014-10-04T04:00:00","value":{"PM2.5":111.06}},{"timestamp":"2014-10-04T05:00:00","value":{"PM2.5":57.18}},{"timestamp":"2014-10-04T06:00:00","value":{"PM2.5":50.87}},{"timestamp":"2014-10-04T07:00:00","value":{"PM2.5":36.43}},{"timestamp":"2014-10-04T08:00:00","value":{"PM2.5":26.89}},{"timestamp":"2014-10-04T09:00:00","value":{"PM2.5":32.66}},{"timestamp":"2014-10-04T10:00:00","value":{"PM2.5":28.13}},{"timestamp":"2014-10-04T11:00:00","value":{"PM2.5":27.61}},{"timestamp":"2014-10-04T12:00:00","value":{"PM2.5":23.81}},{"timestamp":"2014-10-04T13:00:00","value":{"PM2.5":22.02}},{"timestamp":"2014-10-04T14:00:00","value":{"PM2.5":57.46}},{"timestamp":"2014-10-04T15:00:00","value":{"PM2.5":113.64}},{"timestamp":"2014-10-04T16:00:00","value":{"PM2.5":160.12}},{"timestamp":"2014-10-04T17:00:00","value":{"PM2.5":165.16}},{"timestamp":"2014-10-04T18:00:00","value":{"PM2.5":173.02}},{"timestamp":"2014-10-04T19:00:00","value":{"PM2.5":189.23}},{"timestamp":"2014-10-04T20:00:00","value":{"PM2.5":196.8}},{"timestamp":"2014-10-04T21:00:00","value":{"PM2.5":95.37}},{"timestamp":"2014-10-04T22:00:00","value":{"PM2.5":61.04}},{"timestamp":"2014-10-04T23:00:00","value":{"PM2.5":96.14}},{"timestamp":"2014-10-05T00:00:00","value":{"PM2.5":159.21}},{"timestamp":"2014-10-05T01:00:00","value":{"PM2.5":207.61}},{"timestamp":"2014-10-05T02:00:00","value":{"PM2.5":248.96}},{"timestamp":"2014-10-05T03:00:00","value":{"PM2.5":242.87}},{"timestamp":"2014-10-05T04:00:00","value":{"PM2.5":249.19}},{"timestamp":"2014-10-05T05:00:00","value":{"PM2.5":257.44}},{"timestamp":"2014-10-05T06:00:00","value":{"PM2.5":100.41}},{"timestamp":"2014-10-05T07:00:00","value":{"PM2.5":7.17}},{"timestamp":"2014-10-05T08:00:00","value":{"PM2.5":16.69}},{"timestamp":"2014-10-05T09:00:00","value":{"PM2.5":17.64}},{"timestamp":"2014-10-05T10:00:00","value":{"PM2.5":4.41}},{"timestamp":"2014-10-05T11:00:00","value":{"PM2.5":4.49}},{"timestamp":"2014-10-05T12:00:00","value":{"PM2.5":3.34}},{"timestamp":"2014-10-05T13:00:00","value":{"PM2.5":4.92}},{"timestamp":"2014-10-05T14:00:00","value":{"PM2.5":3.15}},{"timestamp":"2014-10-05T15:00:00","value":{"PM2.5":3.9}},{"timestamp":"2014-10-05T16:00:00","value":{"PM2.5":4.24}},{"timestamp":"2014-10-05T17:00:00","value":{"PM2.5":5.59}},{"timestamp":"2014-10-05T18:00:00","value":{"PM2.5":10.31}},{"timestamp":"2014-10-05T19:00:00","value":{"PM2.5":12.9}},{"timestamp":"2014-10-05T20:00:00","value":{"PM2.5":8.41}},{"timestamp":"2014-10-05T21:00:00","value":{"PM2.5":6.59}},{"timestamp":"2014-10-05T22:00:00","value":{"PM2.5":5.58}},{"timestamp":"2014-10-05T23:00:00","value":{"PM2.5":5.86}},{"timestamp":"2014-10-06T00:00:00","value":{"PM2.5":5.76}},{"timestamp":"2014-10-06T01:00:00","value":{"PM2.5":4.57}},{"timestamp":"2014-10-06T02:00:00","value":{"PM2.5":15.34}},{"timestamp":"2014-10-06T03:00:00","value":{"PM2.5":47.56}},{"timestamp":"2014-10-06T04:00:00","value":{"PM2.5":14.69}},{"timestamp":"2014-10-06T05:00:00","value":{"PM2.5":19.45}},{"timestamp":"2014-10-06T06:00:00","value":{"PM2.5":26.48}},{"timestamp":"2014-10-06T07:00:00","value":{"PM2.5":31.39}},{"timestamp":"2014-10-06T08:00:00","value":{"PM2.5":31.24}},{"timestamp":"2014-10-06T09:00:00","value":{"PM2.5":14.77}},{"timestamp":"2014-10-06T10:00:00","value":{"PM2.5":15.32}},{"timestamp":"2014-10-06T11:00:00","value":{"PM2.5":11.1}},{"timestamp":"2014-10-06T12:00:00","value":{"PM2.5":9.58}},{"timestamp":"2014-10-06T13:00:00","value":{"PM2.5":10.22}},{"timestamp":"2014-10-06T14:00:00","value":{"PM2.5":12.62}},{"timestamp":"2014-10-06T15:00:00","value":{"PM2.5":14.64}},{"timestamp":"2014-10-06T16:00:00","value":{"PM2.5":16.44}},{"timestamp":"2014-10-06T17:00:00","value":{"PM2.5":30.07}},{"timestamp":"2014-10-06T18:00:00","value":{"PM2.5":37.81}},{"timestamp":"2014-10-06T19:00:00","value":{"PM2.5":23.24}},{"timestamp":"2014-10-06T20:00:00","value":{"PM2.5":24.93}},{"timestamp":"2014-10-06T21:00:00","value":{"PM2.5":22.06}},{"timestamp":"2014-10-06T22:00:00","value":{"PM2.5":22}},{"timestamp":"2014-10-06T23:00:00","value":{"PM2.5":23.81}},{"timestamp":"2014-10-07T00:00:00","value":{"PM2.5":35.09}},{"timestamp":"2014-10-07T01:00:00","value":{"PM2.5":40.74}},{"timestamp":"2014-10-07T02:00:00","value":{"PM2.5":42.5}},{"timestamp":"2014-10-07T03:00:00","value":{"PM2.5":59.57}},{"timestamp":"2014-10-07T04:00:00","value":{"PM2.5":56.78}},{"timestamp":"2014-10-07T05:00:00","value":{"PM2.5":63.92}},{"timestamp":"2014-10-07T06:00:00","value":{"PM2.5":69.31}},{"timestamp":"2014-10-07T07:00:00","value":{"PM2.5":67.32}},{"timestamp":"2014-10-07T08:00:00","value":{"PM2.5":78.97}},{"timestamp":"2014-10-07T09:00:00","value":{"PM2.5":53.8}},{"timestamp":"2014-10-07T10:00:00","value":{"PM2.5":51.59}},{"timestamp":"2014-10-07T11:00:00","value":{"PM2.5":61.11}},{"timestamp":"2014-10-07T12:00:00","value":{"PM2.5":77.53}},{"timestamp":"2014-10-07T13:00:00","value":{"PM2.5":104.56}},{"timestamp":"2014-10-07T14:00:00","value":{"PM2.5":97.35}},{"timestamp":"2014-10-07T15:00:00","value":{"PM2.5":121.06}},{"timestamp":"2014-10-07T16:00:00","value":{"PM2.5":189.34}},{"timestamp":"2014-10-07T17:00:00","value":{"PM2.5":249.85}},{"timestamp":"2014-10-07T18:00:00","value":{"PM2.5":273.11}},{"timestamp":"2014-10-07T19:00:00","value":{"PM2.5":212.32}},{"timestamp":"2014-10-07T20:00:00","value":{"PM2.5":205.69}},{"timestamp":"2014-10-07T21:00:00","value":{"PM2.5":225.53}},{"timestamp":"2014-10-07T22:00:00","value":{"PM2.5":266.97}},{"timestamp":"2014-10-07T23:00:00","value":{"PM2.5":294.46}},{"timestamp":"2014-10-08T00:00:00","value":{"PM2.5":310.99}},{"timestamp":"2014-10-08T01:00:00","value":{"PM2.5":322.24}},{"timestamp":"2014-10-08T02:00:00","value":{"PM2.5":333.67}},{"timestamp":"2014-10-08T03:00:00","value":{"PM2.5":321.76}},{"timestamp":"2014-10-08T04:00:00","value":{"PM2.5":331.7}},{"timestamp":"2014-10-08T05:00:00","value":{"PM2.5":320.7}},{"timestamp":"2014-10-08T06:00:00","value":{"PM2.5":309.12}},{"timestamp":"2014-10-08T07:00:00","value":{"PM2.5":295.26}},{"timestamp":"2014-10-08T08:00:00","value":{"PM2.5":302.19}},{"timestamp":"2014-10-08T09:00:00","value":{"PM2.5":287.45}},{"timestamp":"2014-10-08T10:00:00","value":{"PM2.5":273.93}},{"timestamp":"2014-10-08T11:00:00","value":{"PM2.5":317.85}},{"timestamp":"2014-10-08T12:00:00","value":{"PM2.5":322.9}},{"timestamp":"2014-10-08T13:00:00","value":{"PM2.5":346.7}},{"timestamp":"2014-10-08T14:00:00","value":{"PM2.5":393.7}},{"timestamp":"2014-10-08T15:00:00","value":{"PM2.5":409.62}},{"timestamp":"2014-10-08T16:00:00","value":{"PM2.5":441.96}},{"timestamp":"2014-10-08T17:00:00","value":{"PM2.5":497.61}},{"timestamp":"2014-10-08T18:00:00","value":{"PM2.5":542.4}},{"timestamp":"2014-10-08T19:00:00","value":{"PM2.5":494.4}},{"timestamp":"2014-10-08T20:00:00","value":{"PM2.5":505.14}},{"timestamp":"2014-10-08T21:00:00","value":{"PM2.5":535.49}},{"timestamp":"2014-10-08T22:00:00","value":{"PM2.5":602.83}},{"timestamp":"2014-10-08T23:00:00","value":{"PM2.5":661.17}},{"timestamp":"2014-10-09T00:00:00","value":{"PM2.5":667.53}},{"timestamp":"2014-10-09T01:00:00","value":{"PM2.5":656.21}},{"timestamp":"2014-10-09T02:00:00","value":{"PM2.5":644.98}},{"timestamp":"2014-10-09T03:00:00","value":{"PM2.5":621.35}},{"timestamp":"2014-10-09T04:00:00","value":{"PM2.5":611.46}},{"timestamp":"2014-10-09T05:00:00","value":{"PM2.5":604.6}},{"timestamp":"2014-10-09T06:00:00","value":{"PM2.5":602.84}},{"timestamp":"2014-10-09T07:00:00","value":{"PM2.5":580.07}},{"timestamp":"2014-10-09T08:00:00","value":{"PM2.5":585.6}},{"timestamp":"2014-10-09T09:00:00","value":{"PM2.5":576.15}},{"timestamp":"2014-10-09T10:00:00","value":{"PM2.5":562.81}},{"timestamp":"2014-10-09T11:00:00","value":{"PM2.5":570.22}},{"timestamp":"2014-10-09T12:00:00","value":{"PM2.5":568.22}},{"timestamp":"2014-10-09T13:00:00","value":{"PM2.5":545.22}},{"timestamp":"2014-10-09T14:00:00","value":{"PM2.5":545.43}},{"timestamp":"2014-10-09T15:00:00","value":{"PM2.5":540.01}},{"timestamp":"2014-10-09T16:00:00","value":{"PM2.5":531.11}},{"timestamp":"2014-10-09T17:00:00","value":{"PM2.5":549.78}},{"timestamp":"2014-10-09T18:00:00","value":{"PM2.5":539.85}},{"timestamp":"2014-10-09T19:00:00","value":{"PM2.5":570.52}},{"timestamp":"2014-10-09T20:00:00","value":{"PM2.5":611.39}},{"timestamp":"2014-10-09T21:00:00","value":{"PM2.5":621.47}},{"timestamp":"2014-10-09T22:00:00","value":{"PM2.5":619.53}},{"timestamp":"2014-10-09T23:00:00","value":{"PM2.5":606.46}},{"timestamp":"2014-10-10T00:00:00","value":{"PM2.5":620.15}},{"timestamp":"2014-10-10T01:00:00","value":{"PM2.5":624.72}},{"timestamp":"2014-10-10T02:00:00","value":{"PM2.5":619.74}},{"timestamp":"2014-10-10T03:00:00","value":{"PM2.5":598.52}},{"timestamp":"2014-10-10T04:00:00","value":{"PM2.5":597.64}},{"timestamp":"2014-10-10T05:00:00","value":{"PM2.5":603.45}},{"timestamp":"2014-10-10T06:00:00","value":{"PM2.5":624.04}},{"timestamp":"2014-10-10T07:00:00","value":{"PM2.5":600.35}},{"timestamp":"2014-10-10T08:00:00","value":{"PM2.5":603.37}},{"timestamp":"2014-10-10T09:00:00","value":{"PM2.5":584.02}},{"timestamp":"2014-10-10T10:00:00","value":{"PM2.5":554.25}},{"timestamp":"2014-10-10T11:00:00","value":{"PM2.5":536.59}},{"timestamp":"2014-10-10T12:00:00","value":{"PM2.5":507.22}},{"timestamp":"2014-10-10T13:00:00","value":{"PM2.5":448.76}},{"timestamp":"2014-10-10T14:00:00","value":{"PM2.5":447.68}},{"timestamp":"2014-10-10T15:00:00","value":{"PM2.5":468.46}},{"timestamp":"2014-10-10T16:00:00","value":{"PM2.5":476.16}},{"timestamp":"2014-10-10T17:00:00","value":{"PM2.5":501.23}},{"timestamp":"2014-10-10T18:00:00","value":{"PM2.5":476.19}},{"timestamp":"2014-10-10T19:00:00","value":{"PM2.5":502.75}},{"timestamp":"2014-10-10T20:00:00","value":{"PM2.5":488.49}},{"timestamp":"2014-10-10T21:00:00","value":{"PM2.5":499.22}},{"timestamp":"2014-10-10T22:00:00","value":{"PM2.5":513.88}},{"timestamp":"2014-10-10T23:00:00","value":{"PM2.5":562.76}},{"timestamp":"2014-10-11T00:00:00","value":{"PM2.5":532.6}},{"timestamp":"2014-10-11T01:00:00","value":{"PM2.5":539.2}},{"timestamp":"2014-10-11T02:00:00","value":{"PM2.5":539.5}},{"timestamp":"2014-10-11T03:00:00","value":{"PM2.5":511.42}},{"timestamp":"2014-10-11T04:00:00","value":{"PM2.5":494.12}},{"timestamp":"2014-10-11T05:00:00","value":{"PM2.5":452.81}},{"timestamp":"2014-10-11T06:00:00","value":{"PM2.5":449.28}},{"timestamp":"2014-10-11T07:00:00","value":{"PM2.5":459.34}},{"timestamp":"2014-10-11T08:00:00","value":{"PM2.5":476.61}},{"timestamp":"2014-10-11T09:00:00","value":{"PM2.5":507.57}},{"timestamp":"2014-10-11T10:00:00","value":{"PM2.5":458.59}},{"timestamp":"2014-10-11T11:00:00","value":{"PM2.5":518.78}},{"timestamp":"2014-10-11T12:00:00","value":{"PM2.5":522.39}},{"timestamp":"2014-10-11T13:00:00","value":{"PM2.5":493.26}},{"timestamp":"2014-10-11T14:00:00","value":{"PM2.5":448.23}},{"timestamp":"2014-10-11T15:00:00","value":{"PM2.5":460.11}},{"timestamp":"2014-10-11T16:00:00","value":{"PM2.5":513.12}},{"timestamp":"2014-10-11T17:00:00","value":{"PM2.5":544.66}},{"timestamp":"2014-10-11T18:00:00","value":{"PM2.5":530}},{"timestamp":"2014-10-11T19:00:00","value":{"PM2.5":52.09}},{"timestamp":"2014-10-11T20:00:00","value":{"PM2.5":10.52}},{"timestamp":"2014-10-11T21:00:00","value":{"PM2.5":9.99}},{"timestamp":"2014-10-11T22:00:00","value":{"PM2.5":6.62}},{"timestamp":"2014-10-11T23:00:00","value":{"PM2.5":12.42}},{"timestamp":"2014-10-12T00:00:00","value":{"PM2.5":6.05}},{"timestamp":"2014-10-12T01:00:00","value":{"PM2.5":4.86}},{"timestamp":"2014-10-12T02:00:00","value":{"PM2.5":4.78}},{"timestamp":"2014-10-12T03:00:00","value":{"PM2.5":4.75}},{"timestamp":"2014-10-12T04:00:00","value":{"PM2.5":6.49}},{"timestamp":"2014-10-12T05:00:00","value":{"PM2.5":4.48}},{"timestamp":"2014-10-12T06:00:00","value":{"PM2.5":4}},{"timestamp":"2014-10-12T07:00:00","value":{"PM2.5":7.4}},{"timestamp":"2014-10-12T08:00:00","value":{"PM2.5":44.28}},{"timestamp":"2014-10-12T09:00:00","value":{"PM2.5":11.98}},{"timestamp":"2014-10-12T10:00:00","value":{"PM2.5":7.86}},{"timestamp":"2014-10-12T11:00:00","value":{"PM2.5":5.37}},{"timestamp":"2014-10-12T12:00:00","value":{"PM2.5":4.19}},{"timestamp":"2014-10-12T13:00:00","value":{"PM2.5":8}},{"timestamp":"2014-10-12T14:00:00","value":{"PM2.5":4.62}},{"timestamp":"2014-10-12T15:00:00","value":{"PM2.5":5.06}},{"timestamp":"2014-10-12T16:00:00","value":{"PM2.5":4.29}},{"timestamp":"2014-10-12T17:00:00","value":{"PM2.5":7.34}},{"timestamp":"2014-10-12T18:00:00","value":{"PM2.5":7.85}},{"timestamp":"2014-10-12T19:00:00","value":{"PM2.5":6.72}},{"timestamp":"2014-10-12T20:00:00","value":{"PM2.5":5.16}},{"timestamp":"2014-10-12T21:00:00","value":{"PM2.5":7.82}},{"timestamp":"2014-10-12T22:00:00","value":{"PM2.5":10.13}},{"timestamp":"2014-10-12T23:00:00","value":{"PM2.5":7.02}},{"timestamp":"2014-10-13T00:00:00","value":{"PM2.5":5.91}},{"timestamp":"2014-10-13T01:00:00","value":{"PM2.5":4.43}},{"timestamp":"2014-10-13T02:00:00","value":{"PM2.5":4.17}},{"timestamp":"2014-10-13T03:00:00","value":{"PM2.5":4.26}},{"timestamp":"2014-10-13T04:00:00","value":{"PM2.5":4.16}},{"timestamp":"2014-10-13T05:00:00","value":{"PM2.5":3.49}},{"timestamp":"2014-10-13T06:00:00","value":{"PM2.5":3.22}},{"timestamp":"2014-10-13T07:00:00","value":{"PM2.5":3.78}},{"timestamp":"2014-10-13T08:00:00","value":{"PM2.5":6.02}},{"timestamp":"2014-10-13T09:00:00","value":{"PM2.5":5.49}},{"timestamp":"2014-10-13T10:00:00","value":{"PM2.5":3.18}},{"timestamp":"2014-10-13T11:00:00","value":{"PM2.5":2.84}},{"timestamp":"2014-10-13T12:00:00","value":{"PM2.5":4.08}},{"timestamp":"2014-10-13T13:00:00","value":{"PM2.5":4.16}},{"timestamp":"2014-10-13T14:00:00","value":{"PM2.5":5.6}},{"timestamp":"2014-10-13T15:00:00","value":{"PM2.5":8.37}},{"timestamp":"2014-10-13T16:00:00","value":{"PM2.5":11.02}},{"timestamp":"2014-10-13T17:00:00","value":{"PM2.5":44.35}},{"timestamp":"2014-10-13T18:00:00","value":{"PM2.5":59.91}},{"timestamp":"2014-10-13T19:00:00","value":{"PM2.5":13.51}},{"timestamp":"2014-10-13T20:00:00","value":{"PM2.5":11.44}},{"timestamp":"2014-10-13T21:00:00","value":{"PM2.5":9.64}},{"timestamp":"2014-10-13T22:00:00","value":{"PM2.5":15.66}},{"timestamp":"2014-10-13T23:00:00","value":{"PM2.5":25.69}},{"timestamp":"2014-10-14T00:00:00","value":{"PM2.5":21.18}},{"timestamp":"2014-10-14T01:00:00","value":{"PM2.5":40.7}},{"timestamp":"2014-10-14T02:00:00","value":{"PM2.5":29.56}},{"timestamp":"2014-10-14T03:00:00","value":{"PM2.5":32.76}},{"timestamp":"2014-10-14T04:00:00","value":{"PM2.5":51.26}},{"timestamp":"2014-10-14T05:00:00","value":{"PM2.5":39.45}},{"timestamp":"2014-10-14T06:00:00","value":{"PM2.5":38.68}},{"timestamp":"2014-10-14T07:00:00","value":{"PM2.5":50.31}},{"timestamp":"2014-10-14T08:00:00","value":{"PM2.5":31.9}},{"timestamp":"2014-10-14T09:00:00","value":{"PM2.5":22.37}},{"timestamp":"2014-10-14T10:00:00","value":{"PM2.5":20.02}},{"timestamp":"2014-10-14T11:00:00","value":{"PM2.5":22.58}},{"timestamp":"2014-10-14T12:00:00","value":{"PM2.5":24.72}},{"timestamp":"2014-10-14T13:00:00","value":{"PM2.5":-1}},{"timestamp":"2014-10-14T14:00:00","value":{"PM2.5":37.88}},{"timestamp":"2014-10-14T15:00:00","value":{"PM2.5":44.28}},{"timestamp":"2014-10-14T16:00:00","value":{"PM2.5":76.53}},{"timestamp":"2014-10-14T17:00:00","value":{"PM2.5":112.3}},{"timestamp":"2014-10-14T18:00:00","value":{"PM2.5":117.97}},{"timestamp":"2014-10-14T19:00:00","value":{"PM2.5":64.34}},{"timestamp":"2014-10-14T20:00:00","value":{"PM2.5":55.34}},{"timestamp":"2014-10-14T21:00:00","value":{"PM2.5":50.97}},{"timestamp":"2014-10-14T22:00:00","value":{"PM2.5":48.59}},{"timestamp":"2014-10-14T23:00:00","value":{"PM2.5":52.1}},{"timestamp":"2014-10-15T00:00:00","value":{"PM2.5":52.31}},{"timestamp":"2014-10-15T01:00:00","value":{"PM2.5":56.92}},{"timestamp":"2014-10-15T02:00:00","value":{"PM2.5":54.36}},{"timestamp":"2014-10-15T03:00:00","value":{"PM2.5":54.43}},{"timestamp":"2014-10-15T04:00:00","value":{"PM2.5":142.32}},{"timestamp":"2014-10-15T05:00:00","value":{"PM2.5":80.46}},{"timestamp":"2014-10-15T06:00:00","value":{"PM2.5":105.69}},{"timestamp":"2014-10-15T07:00:00","value":{"PM2.5":103.53}},{"timestamp":"2014-10-15T08:00:00","value":{"PM2.5":106.21}},{"timestamp":"2014-10-15T09:00:00","value":{"PM2.5":89.81}},{"timestamp":"2014-10-15T10:00:00","value":{"PM2.5":109.88}},{"timestamp":"2014-10-15T11:00:00","value":{"PM2.5":115.99}},{"timestamp":"2014-10-15T12:00:00","value":{"PM2.5":33.9}},{"timestamp":"2014-10-15T13:00:00","value":{"PM2.5":18.13}},{"timestamp":"2014-10-15T14:00:00","value":{"PM2.5":21.07}},{"timestamp":"2014-10-15T15:00:00","value":{"PM2.5":23.38}},{"timestamp":"2014-10-15T16:00:00","value":{"PM2.5":12.68}},{"timestamp":"2014-10-15T17:00:00","value":{"PM2.5":11.12}},{"timestamp":"2014-10-15T18:00:00","value":{"PM2.5":11.13}},{"timestamp":"2014-10-15T19:00:00","value":{"PM2.5":11.22}},{"timestamp":"2014-10-15T20:00:00","value":{"PM2.5":10.27}},{"timestamp":"2014-10-15T21:00:00","value":{"PM2.5":11.33}},{"timestamp":"2014-10-15T22:00:00","value":{"PM2.5":12.96}},{"timestamp":"2014-10-15T23:00:00","value":{"PM2.5":10.63}},{"timestamp":"2014-10-16T00:00:00","value":{"PM2.5":6.99}},{"timestamp":"2014-10-16T01:00:00","value":{"PM2.5":21.17}},{"timestamp":"2014-10-16T02:00:00","value":{"PM2.5":7.95}},{"timestamp":"2014-10-16T03:00:00","value":{"PM2.5":18.09}},{"timestamp":"2014-10-16T04:00:00","value":{"PM2.5":19.63}},{"timestamp":"2014-10-16T05:00:00","value":{"PM2.5":28.84}},{"timestamp":"2014-10-16T06:00:00","value":{"PM2.5":30.77}},{"timestamp":"2014-10-16T07:00:00","value":{"PM2.5":35.48}},{"timestamp":"2014-10-16T08:00:00","value":{"PM2.5":41.14}},{"timestamp":"2014-10-16T09:00:00","value":{"PM2.5":19.42}},{"timestamp":"2014-10-16T10:00:00","value":{"PM2.5":19.65}},{"timestamp":"2014-10-16T11:00:00","value":{"PM2.5":34.61}},{"timestamp":"2014-10-16T12:00:00","value":{"PM2.5":46.08}},{"timestamp":"2014-10-16T13:00:00","value":{"PM2.5":46.72}},{"timestamp":"2014-10-16T14:00:00","value":{"PM2.5":47.4}},{"timestamp":"2014-10-16T15:00:00","value":{"PM2.5":51.82}},{"timestamp":"2014-10-16T16:00:00","value":{"PM2.5":68.41}},{"timestamp":"2014-10-16T17:00:00","value":{"PM2.5":67.81}},{"timestamp":"2014-10-16T18:00:00","value":{"PM2.5":200.82}},{"timestamp":"2014-10-16T19:00:00","value":{"PM2.5":49.54}},{"timestamp":"2014-10-16T20:00:00","value":{"PM2.5":60.66}},{"timestamp":"2014-10-16T21:00:00","value":{"PM2.5":61.39}},{"timestamp":"2014-10-16T22:00:00","value":{"PM2.5":61.92}},{"timestamp":"2014-10-16T23:00:00","value":{"PM2.5":64.39}}]}

data = function(){
   var dataSet = [];
   data.forEach(function(rawDataObj){
    for (var i=0; i<rawDataObj.pitches.length; i++){
     var dataObj = {
        dataObj['start'] = rawDataObj.start,
        dataObj['pitch'] = i,
        dataObj['value'] = rawDataObj[i]
     };
     dataSet.push(dataObj);
  }
})
   return dataSet;
}

// data.forEach(function(valueObj){
//    valueObj['date'] = timeFormat.parse(valueObj['timestamp']);
//    var day = valueObj['day'] = monthDayFormat(valueObj['date']);

//    var dayData = dailyValueExtent[day] = (dailyValueExtent[day] || [1000,-1]);
//    var pmValue = valueObj['value']['PM2.5'];
//    dayData[0] = d3.min([dayData[0],pmValue]);
//    dayData[1] = d3.max([dayData[1],pmValue]);
// });

timeExtent = data.length/12;

axisWidth = itemSize*timeExtent;

    //render axises
    xAxis.scale(xAxisScale.range([0,axisWidth]).domain([0,timeExtent]));  
    svg.append('g')
    .attr('transform','translate('+margin.left+','+margin.top+')')
    .attr('class','x axis')
    .call(xAxis)
    .append('text')
    .text('date')
    .attr('transform','translate('+axisWidth+',-10)');

    svg.append('g')
    .attr('transform','translate('+margin.left+','+margin.top+')')
    .attr('class','y axis')
    .call(yAxis)
    .append('text')
    .text('time')
    .attr('transform','translate(-10,'+axisHeight+') rotate(-90)');

    //render heatmap rects
    dayOffset = dayFormat(dateExtent[0]);
    rect = heatmap.selectAll('rect')
    .data(data)
    .enter().append('rect')
    .attr('width',cellSize)
    .attr('height',cellSize)
    .attr('x',function(d){
       return itemSize*(dayFormat(d.date)-dayOffset);
    })
    .attr('y',function(d){          
       return hourFormat(d.date)*itemSize;
    })
    .attr('fill','#ffffff');

    // rect.filter(function(d){ return d.value['PM2.5']>0;})
    // .append('title')
    // .text(function(d){
    //    return monthDayFormat(d.date)+' '+d.value;
    // });

    renderColor();
  // });

function initCalibration(){
  d3.select('[role="calibration"] [role="example"]').select('svg')
  .selectAll('rect').data(colorCalibration).enter()
  .append('rect')
  .attr('width',cellSize)
  .attr('height',cellSize)
  .attr('x',function(d,i){
    return i*itemSize;
 })
  .attr('fill',function(d){
    return d;
 });

    //bind click event
    d3.selectAll('[role="calibration"] [name="displayType"]').on('click',function(){
      renderColor();
   });
 }

 function renderColor(){

  rect
 //  .filter(function(d){
 //    return (d.value['PM2.5']>=0);
 // })
  .transition()
  .delay(function(d){      
    return (dayFormat(d.date)-dayOffset)*15;
 })
  .duration(500)
  .attrTween('fill',function(d,i,a){
        //choose color dynamicly      
        var colorIndex = d3.scale.quantize()
        .range([0,1,2,3,4,5])
        .domain([0,1]);

        return d3.interpolate(a,colorCalibration[colorIndex(d.value)]);
     });
}

  //extend frame height in `http://bl.ocks.org/`
  d3.select(self.frameElement).style("height", "600px");  
}
